import{u as f,h as u,d as m,t as p}from"./utilities.cBO0Ui88.js";const w={namespaces:{tei:"http://www.tei-c.org/ns/1.0",teieg:"http://www.tei-c.org/ns/Examples",rng:"http://relaxng.org/ns/structure/1.0"},tei:{eg:["<pre>","</pre>"],ptr:['<a href="$rw@target">$@target</a>'],ref:[["[target]",['<a href="$rw@target">',"</a>"]]],graphic:function(n){let e=new Image;return e.src=this.rw(n.getAttribute("url")),n.hasAttribute("width")&&e.setAttribute("width",n.getAttribute("width")),n.hasAttribute("height")&&e.setAttribute("height",n.getAttribute("height")),e},list:[["[type=gloss]",function(n){const e=n.ownerDocument;let t=e.createElement("dl");for(let i of Array.from(n.children))if(i.nodeType==1){if(i.localName=="tei-label"){let o=e.createElement("dt");o.innerHTML=i.innerHTML,t.appendChild(o)}if(i.localName=="tei-item"){let o=e.createElement("dd");o.innerHTML=i.innerHTML,t.appendChild(o)}}return t}]],note:[["[place=end]",function(n){const e=n.ownerDocument;this.noteIndex?this.noteIndex++:this.noteIndex=1;let t="_note_"+this.noteIndex,i=e.createElement("a");i.setAttribute("id","src"+t),i.setAttribute("href","#"+t),i.innerHTML=this.noteIndex;let o=e.createElement("sup");o.appendChild(i);let s=e.querySelector("ol.notes");s||(s=e.createElement("ol"),s.setAttribute("class","notes"),this.dom.appendChild(s));let r=e.createElement("li");return r.id=t,r.innerHTML=n.innerHTML,s.appendChild(r),o}],["_",["(",")"]]],teiHeader:function(n){this.hideContent(n,!1)},title:[["tei-titlestmt>tei-title",function(n){const e=n.ownerDocument;let t=e.createElement("title");t.innerHTML=n.innerText,e.querySelector("head").appendChild(t)}]]},teieg:{egXML:function(n){let t=n.ownerDocument.createElement("pre"),i=this.serialize(n,!0).replace(/</g,"&lt;"),o=i.match(/^[\t ]+/);return o&&(i=i.replace(new RegExp("^"+o[0],"mg"),"")),t.innerHTML=i,t}}};function g(n){if(n.namespaces)for(let e of Object.keys(n.namespaces))!this.namespaces.has(n.namespaces[e])&&!Array.from(this.namespaces.values()).includes(e)&&this.namespaces.set(n.namespaces[e],e);for(let e of this.namespaces.values())if(n[e])for(let t of Object.keys(n[e]))this.behaviors[`${e}:${t}`]=n[e][t];if(n.functions)for(let e of Object.keys(n.functions))this.utilities[e]=n.functions[e];n.handlers&&console.log("Behavior handlers are no longer used."),n.fallbacks&&console.log("Fallback behaviors are no longer used.")}function b(n,e,t){let i;if(n===Object(n))for(let o of Object.keys(n))this.namespaces.has(n[o])||(this.namespaces.set(n[o],o),i=o);else i=n;this.behaviors[`${i}:${e}`]=t}function A(n,e){let t;if(n===Object(n))for(let i of Object.keys(n))this.namespaces.has(n[i])||(this.namespaces.set(n[i],i),t=i);else t=n;delete this.behaviors[`${t}:${e}`]}function y(n,e){const t=n.documentElement;let i=1,o=function(r){return e.has(r.namespaceURI?r.namespaceURI:"")||e.set(r.namespaceURI,"ns"+i++),e.get(r.namespaceURI?r.namespaceURI:"")+":"+r.localName};const s=new Set(Array.from(t.querySelectorAll("*"),o));return s.add(o(t)),s}function E(n){return Array.from(n.querySelectorAll("*[data-origname]"),e=>e.localName.replace(/(\w+)-.+/,"$1:")+e.getAttribute("data-origname"))}class c{constructor(e){this.options=e||{},this.document=this.options.documentObject?this.options.documentObject:void 0,this.document===void 0&&(typeof window<"u"&&window.document?this.document=window.document:typeof global<"u"&&global.document&&(this.document=global.document)),this.addBehaviors=g.bind(this),this.addBehavior=b.bind(this),this.removeBehavior=A.bind(this),this.utilities={};for(const t of Object.keys(f))["getPrefixDef","rw","resolveURI"].includes(t)?this.utilities[t]=f[t].bind(this):this.utilities[t]=f[t];if(this.els=[],this.namespaces=new Map,this.behaviors={},this.hasStyle=!1,this.prefixDefs=[],this.debug=this.options.debug===!0,this.discardContent=this.options.discardContent===!0,this.options.base)this.base=this.options.base;else try{window&&(this.base=window.location.href.replace(/\/[^\/]*$/,"/"))}catch{this.base=""}this.options.omitDefaultBehaviors||this.addBehaviors(w),this.options.ignoreFragmentId&&window&&window.removeEventListener("ceteiceanload",c.restorePosition)}getHTML5(e,t,i){return window&&window.location.href.startsWith(this.base)&&e.indexOf("/")>=0&&(this.base=e.replace(/\/[^\/]*$/,"/")),new Promise(function(s,r){let a=new XMLHttpRequest;a.open("GET",e),a.send(),a.onload=function(){this.status>=200&&this.status<300?s(this.response):r(this.statusText)},a.onerror=function(){r(this.statusText)}}).catch(function(s){console.log("Could not get XML file."),this.debug&&console.log(s)}).then(s=>this.makeHTML5(s,t,i))}makeHTML5(e,t,i){return this.XML_dom=new DOMParser().parseFromString(e,"text/xml"),this.domToHTML5(this.XML_dom,t,i)}preprocess(e,t,i){this.els=y(e,this.namespaces);let o=s=>{let r;if(this.namespaces.has(s.namespaceURI?s.namespaceURI:"")){let a=this.namespaces.get(s.namespaceURI?s.namespaceURI:"");r=this.document.createElement(`${a}-${s.localName}`)}else r=this.document.importNode(s,!1);for(let a of Array.from(s.attributes))a.name=="xmlns"?r.setAttribute("data-xmlns",a.value):r.setAttribute(a.name,a.value),a.name=="xml:id"&&r.setAttribute("id",a.value),a.name=="xml:lang"&&r.setAttribute("lang",a.value),a.name=="rendition"&&r.setAttribute("class",a.value.replace(/#/g,""));if(r.setAttribute("data-origname",s.localName),s.hasAttributes()&&r.setAttribute("data-origatts",s.getAttributeNames().join(" ")),s.childNodes.length==0&&r.setAttribute("data-empty",""),s.localName=="head"){let a=e.evaluate("count(ancestor::*[tei:head])",s,function(l){if(l=="tei")return"http://www.tei-c.org/ns/1.0"},1,null);r.setAttribute("data-level",a.numberValue)}if(s.localName=="tagsDecl"){let a=this.document.createElement("style");for(let l of Array.from(s.childNodes))if(l.nodeType==1&&l.localName=="rendition"&&l.getAttribute("scheme")=="css"){let d="";l.hasAttribute("selector")?(d+=l.getAttribute("selector").replace(/([^#, >]+\w*)/g,"tei-$1").replace(/#tei-/g,"#")+`{
`,d+=l.textContent):(d+="."+l.getAttribute("xml:id")+`{
`,d+=l.textContent),d+=`
}
`,a.appendChild(this.document.createTextNode(d))}a.childNodes.length>0&&(r.appendChild(a),this.hasStyle=!0)}s.localName=="prefixDef"&&(this.prefixDefs.push(s.getAttribute("ident")),this.prefixDefs[s.getAttribute("ident")]={matchPattern:s.getAttribute("matchPattern"),replacementPattern:s.getAttribute("replacementPattern")});for(let a of Array.from(s.childNodes))a.nodeType==1?r.appendChild(o(a)):r.appendChild(a.cloneNode());return i&&i(r,s),r};if(this.dom=o(e.documentElement),this.utilities.dom=this.dom,t)t(this.dom,this),window&&window.dispatchEvent(h);else return typeof window<"u"&&window.dispatchEvent(h),this.dom}domToHTML5(e,t,i){if(this.preprocess(e,null,i),this.applyBehaviors(),this.done=!0,t)t(this.dom,this),window&&window.dispatchEvent(h);else return typeof window<"u"&&window.dispatchEvent(h),this.dom}processPage(){this.els=E(this.document),this.applyBehaviors()}unsetNamespace(e){this.namespaces.delete(e)}setBaseUrl(e){this.base=e}append(e,t){let i=this;if(t){let o=e.call(i.utilities,t);o&&!i.childExists(t.firstElementChild,o.nodeName)&&i.appendBasic(t,o)}else return function(){if(!this.hasAttribute("data-processed")){let o=e.call(i.utilities,this);o&&!i.childExists(this.firstElementChild,o.nodeName)&&i.appendBasic(this,o)}}}appendBasic(e,t){this.discardContent?e.innerHTML="":u(e,!0),e.appendChild(t)}bName(e){return e.tagName.substring(0,e.tagName.indexOf("-")).toLowerCase()+":"+e.getAttribute("data-origname")}childExists(e,t){return e&&e.nodeName==t?!0:e&&e.nextElementSibling&&this.childExists(e.nextElementSibling,t)}decorator(e){if(Array.isArray(e)&&e.length==0)return function(i){};if(Array.isArray(e)&&!Array.isArray(e[0]))return this.applyDecorator(e);let t=this;return function(i){for(let o of e)if(i.matches(o[0])||o[0]==="_")return Array.isArray(o[1])?t.decorator(o[1]).call(this,i):o[1].call(this,i)}}applyDecorator(e){let t=this;return function(i){let o=[];for(let s=0;s<e.length;s++)o.push(t.template(e[s],i));return t.insert(i,o)}}getFallback(e,t){if(e[t])return e[t]instanceof Function?e[t]:this.decorator(e[t])}getHandler(e,t){if(e[t])return e[t]instanceof Function?this.append(e[t]):this.append(this.decorator(e[t]))}insert(e,t){let i=this.document.createElement("span");for(let o of Array.from(e.childNodes))o.nodeType===1&&!o.hasAttribute("data-processed")&&this.processElement(o);if(t[0].match("<[^>]+>")&&t[1]&&t[1].match("<[^>]+>"))i.innerHTML=t[0]+e.innerHTML+(t[1]?t[1]:"");else{i.innerHTML=t[0],i.setAttribute("data-before",t[0].replace(/<[^>]+>/g,"").length);for(let o of Array.from(e.childNodes))i.appendChild(o.cloneNode(!0));t.length>1&&(i.innerHTML+=t[1],i.setAttribute("data-after",t[1].replace(/<[^>]+>/g,"").length))}return i}processElement(e){if(e.hasAttribute("data-origname")&&!e.hasAttribute("data-processed")){let t=this.getFallback(this.bName(e));t&&(this.append(t,e),e.setAttribute("data-processed",""))}for(let t of Array.from(e.childNodes))t.nodeType===1&&this.processElement(t)}template(e,t){let i=e;if(e.search(/\$(\w*)(@([a-zA-Z:]+))/)){let o=/\$(\w*)@([a-zA-Z:]+)/g,s;for(;s=o.exec(e);)t.hasAttribute(s[2])?s[1]&&this.utilities[s[1]]?i=i.replace(s[0],this.utilities[s[1]](t.getAttribute(s[2]))):i=i.replace(s[0],t.getAttribute(s[2])):i=i.replace(s[0],"")}return i}applyBehaviors(){typeof window<"u"&&window.customElements?this.define.call(this,this.els):this.fallback.call(this,this.els)}define(e){for(let t of e){const i=this.getHandler(this.behaviors,t);m(t,i,this.debug)}}fallback(e){for(let t of e){let i=this.getFallback(this.behaviors,t);if(i)for(let o of Array.from((this.dom&&!this.done?this.dom:this.document).getElementsByTagName(p(t))))o.hasAttribute("data-processed")||this.append(i,o)}}static savePosition(){window.sessionStorage.setItem(window.location+"-scroll",window.scrollY)}static restorePosition(){if(window.location.hash)setTimeout(function(){let e=this.document.querySelector(window.decodeURI(window.location.hash));e&&e.scrollIntoView()},100);else{let e;(e=window.sessionStorage.getItem(window.location+"-scroll"))&&setTimeout(function(){window.scrollTo(0,e)},100)}}}try{if(typeof window<"u"){window.CETEI=c,window.addEventListener("beforeunload",c.savePosition);var h=new Event("ceteiceanload");window.addEventListener("ceteiceanload",c.restorePosition)}}catch(n){console.log(n)}export{c as default};
